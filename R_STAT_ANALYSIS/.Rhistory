knitr::opts_chunk$set(echo = TRUE)
data <- read.csv("../R_Data/diet.csv", header=T)
names(data)
data
data <- read.csv("../R_Data/diet.csv", header=T)
names(data)
data
diff <- Before - After
attach(data)
diff <- Before - After
diff
boxplot(diff)
ggplot(data, aes(x=diff)) + geom_boxplot()
library(ggplot2)
ggplot(data, aes(x=diff)) + geom_boxplot()
ggplot(data, aes(x=1, y=diff)) + geom_boxplot()
boxplot(diff)
par(mfrow=c(1,2))
boxplot(diff)
ggplot(data, aes(x=1, y=diff)) + geom_boxplot()
par(mfrow=c(1,2))
boxplot(diff)
ggplot(data, aes(x=1, y=diff)) + geom_boxplot()
boxplot(diff)
ggplot(data, aes(x=1, y=diff)) + geom_boxplot()
boxplot(diff)
ggplot(data, aes(x=1, y=diff)) + geom_boxplot()
mean_diff <- mean(diff)
mean_diff
sd_diff <- sd(diff)
sd_diff
t_stat <- mean_diff/(sd_diff/sqrt(length(diff)))
t_stat
t.test(Before, After, alternative=c("two.sided"), paired=TRUE, conf.level=0.95)
t.test(Before, After, alternative=c("greater"), paired=TRUE, conf.level=0.95)
library(faraway)
### 라이브러리 불러오기
* 패키지가 없다고 뜨면 install.packages()를이용하여 설치를 진행
install.packages("faraway")
```{r cars}
library(faraway)
```
library(faraway)
search()
data(pima, package="faraway")
data(pima, package="faraway")
pima$test <- factor(pima$test)
dim(pima)
head(pima)
str(pima)
* 데이터의 확인 내용을 간단하게 Notepad에 적어보자.
pima?
### pima
*
* 데이터의 확인 내용을 간단하게 Notepad에 적어보자.
?pima
### pima
*
m <- glm(test ~ pregnant + glucose + bmi, family=binomial, data=train)
# 샘플 5:5
idx <- sample(NROW(pima)/2)
# 데이터 셋 나누기
train <- pima[idx, ]
test <- pima[-idx, ]
m <- glm(test ~ pregnant + glucose + bmi, family=binomial, data=train)
m
summary(m)
pred <- predict(m , newdata = test , type = "response")
pred
library(pscl)
### 라이브러리 불러오기
* 패키지가 없다고 뜨면 install.packages()를이용하여 설치를 진행
* install.packages("faraway")
install.packages("pscl")
```{r cars}
library(faraway)
search()
```
library(pscl)
search()
library(pscl)
pR2(model)
library(pscl)
pR2(m)
pred <- predict(m , newdata = test , type = "response")
pred[0:10]
pred <- predict(m , newdata = test , type = "response")
pred[0:10]  # 10개만 보기
# 0 또는 1로 해야 하므로 0.5를 기준으로 TRUE(1), FALSE(0)로 나눈다.
pred <- as.integer(pred > 0.5)
pred[0:10]  # 10개만 보기
actual <- test[ , "test"]
xt = xtabs( ~ pred + actual)
xt
# 확률로 분할표 보기
prop.table(xt)
# caret 패키지를 이용한 정확도 및 기타 확인
library(caret)
pred <- as.factor(pred)
confusionMatrix(pred, actual)
library(faraway)
library(caret)
search()
# caret 패키지를 이용한 정확도 및 기타 확인
# library(caret)
pred <- as.factor(pred)
confusionMatrix(pred, actual)
library(ROCR)
library(ROCR)
pred_prob <- predict(m , newdata = test , type = "response")  # 확률 값
pred_prob
str(pred_prob)
str(test)
# ROC 커브를 위한 pima의 test 변수을 labels로 지정
labels <- test[  ,"test"]
pred3 <- prediction(pred_prob , labels)
plot(performance(pred3 , "tpr" , "fpr"))
# AUC 값 확인
performance(pred3, "auc")
plot(performance(pred3 , "tpr" , "fpr"))
library(ROCR)
pred_prob <- predict(m , newdata = test , type = "response")  # 확률 값
str(test)
# ROC 커브를 위한 pima의 test 변수을 labels로 지정
labels <- test[  ,"test"]
pred3 <- prediction(pred_prob , labels)
plot(performance(pred3 , "tpr" , "fpr"))
# AUC 값 확인(1의 값에 가까울 수록 좋다.)
performance(pred3, "auc")
