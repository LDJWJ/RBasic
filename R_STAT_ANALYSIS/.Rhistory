knitr::opts_chunk$set(echo = TRUE)
data <- read.csv("../R_Data/diet.csv", header=T)
names(data)
data
data <- read.csv("../R_Data/diet.csv", header=T)
names(data)
data
diff <- Before - After
attach(data)
diff <- Before - After
diff
boxplot(diff)
ggplot(data, aes(x=diff)) + geom_boxplot()
library(ggplot2)
ggplot(data, aes(x=diff)) + geom_boxplot()
ggplot(data, aes(x=1, y=diff)) + geom_boxplot()
boxplot(diff)
par(mfrow=c(1,2))
boxplot(diff)
ggplot(data, aes(x=1, y=diff)) + geom_boxplot()
par(mfrow=c(1,2))
boxplot(diff)
ggplot(data, aes(x=1, y=diff)) + geom_boxplot()
boxplot(diff)
ggplot(data, aes(x=1, y=diff)) + geom_boxplot()
boxplot(diff)
ggplot(data, aes(x=1, y=diff)) + geom_boxplot()
mean_diff <- mean(diff)
mean_diff
sd_diff <- sd(diff)
sd_diff
t_stat <- mean_diff/(sd_diff/sqrt(length(diff)))
t_stat
t.test(Before, After, alternative=c("two.sided"), paired=TRUE, conf.level=0.95)
t.test(Before, After, alternative=c("greater"), paired=TRUE, conf.level=0.95)
library(faraway)
### 라이브러리 불러오기
* 패키지가 없다고 뜨면 install.packages()를이용하여 설치를 진행
install.packages("faraway")
```{r cars}
library(faraway)
```
library(faraway)
search()
data(pima, package="faraway")
data(pima, package="faraway")
pima$test <- factor(pima$test)
dim(pima)
head(pima)
str(pima)
* 데이터의 확인 내용을 간단하게 Notepad에 적어보자.
pima?
### pima
*
* 데이터의 확인 내용을 간단하게 Notepad에 적어보자.
?pima
### pima
*
m <- glm(test ~ pregnant + glucose + bmi, family=binomial, data=train)
# 샘플 5:5
idx <- sample(NROW(pima)/2)
# 데이터 셋 나누기
train <- pima[idx, ]
test <- pima[-idx, ]
m <- glm(test ~ pregnant + glucose + bmi, family=binomial, data=train)
m
summary(m)
pred <- predict(m , newdata = test , type = "response")
pred
library(pscl)
### 라이브러리 불러오기
* 패키지가 없다고 뜨면 install.packages()를이용하여 설치를 진행
* install.packages("faraway")
install.packages("pscl")
```{r cars}
library(faraway)
search()
```
library(pscl)
search()
library(pscl)
pR2(model)
library(pscl)
pR2(m)
pred <- predict(m , newdata = test , type = "response")
pred[0:10]
pred <- predict(m , newdata = test , type = "response")
pred[0:10]  # 10개만 보기
# 0 또는 1로 해야 하므로 0.5를 기준으로 TRUE(1), FALSE(0)로 나눈다.
pred <- as.integer(pred > 0.5)
pred[0:10]  # 10개만 보기
actual <- test[ , "test"]
xt = xtabs( ~ pred + actual)
xt
# 확률로 분할표 보기
prop.table(xt)
# caret 패키지를 이용한 정확도 및 기타 확인
library(caret)
pred <- as.factor(pred)
confusionMatrix(pred, actual)
library(faraway)
library(caret)
search()
# caret 패키지를 이용한 정확도 및 기타 확인
# library(caret)
pred <- as.factor(pred)
confusionMatrix(pred, actual)
library(ROCR)
library(ROCR)
pred_prob <- predict(m , newdata = test , type = "response")  # 확률 값
pred_prob
str(pred_prob)
str(test)
# ROC 커브를 위한 pima의 test 변수을 labels로 지정
labels <- test[  ,"test"]
pred3 <- prediction(pred_prob , labels)
plot(performance(pred3 , "tpr" , "fpr"))
# AUC 값 확인
performance(pred3, "auc")
plot(performance(pred3 , "tpr" , "fpr"))
library(ROCR)
pred_prob <- predict(m , newdata = test , type = "response")  # 확률 값
str(test)
# ROC 커브를 위한 pima의 test 변수을 labels로 지정
labels <- test[  ,"test"]
pred3 <- prediction(pred_prob , labels)
plot(performance(pred3 , "tpr" , "fpr"))
# AUC 값 확인(1의 값에 가까울 수록 좋다.)
performance(pred3, "auc")
kor <- c(50,70,80,90,100)
eng <- c(77,88,99,100,70)
math <- c(55, 75, 85, 95, 105)
all_score <- data.frame(kor, eng, math)
all_score
model <- lm(math~kor, data=all_score)
model
summary(model)
model <- lm(math~kor+eng, data=all_score)
model
model1 <- lm(math~kor, data=all_score)
model1
model2 <- lm(math~kor+eng, data=all_score)
model2
# 하나의 변수로 이용한 예측
dat <- data.frame(c(80,85))
pred1
# 하나의 변수로 이용한 예측
dat <- data.frame(c(80,85))
pred1 <- predict(model1, newdata=dat)
pred1 <- predict(model1, newdata=dat)
pred1
pred1
# 하나의 변수로 이용한 예측
dat <- data.frame(c(80,85))
pred1 <- predict(model1, newdata=dat)
# 하나의 변수로 이용한 예측
dat <- data.frame(kor=c(80,85))
pred1 <- predict(model1, newdata=dat)
pred1
# 두개의 변수로 이용한 예측
dat <- data.frame(kor=c(80,85), c(50,60))
pred1 <- predict(model2, newdata=dat)
# 두개의 변수로 이용한 예측
dat <- data.frame(kor=c(80,85), eng=c(50,60))
pred2 <- predict(model2, newdata=dat)
pred2
# 하나의 변수로 이용한 예측
dat <- data.frame(kor=c(80,85))
pred1 <- predict(model1, newdata=dat)
pred1
# 두개의 변수로 이용한 예측
dat <- data.frame(kor=c(80,85), eng=c(50,60))
pred2 <- predict(model2, newdata=dat)
pred2
summary(model1)
summary(model2)
summary(model1)
summary(model2)
summary(model1)
summary(model1)
summary(model2)
kor <- c(50,70,80,90,100)
eng <- c(77,88,99,100,70)
math <- c(55, 75, 85, 95, 105)
all_score <- data.frame(kor, eng, math)
all_score
model1 <- lm(math~kor, data=all_score)
model1
summary(model1)
model2 <- lm(math~kor+eng, data=all_score)
model2
# 하나의 변수로 이용한 예측
dat <- data.frame(kor=c(80,85))
pred1 <- predict(model1, newdata=dat)
pred1
# 두개의 변수로 이용한 예측
dat <- data.frame(kor=c(80,85), eng=c(50,60))
pred2 <- predict(model2, newdata=dat)
pred2
summary(model1)
summary(model2)
source('~/GitHub/RBasic/R_STAT_ANALYSIS/R_ML_ANA_Practice02.r', encoding = 'UTF-8', echo=TRUE)
source('~/GitHub/RBasic/R_STAT_ANALYSIS/R_ML_ANA_Practice02.r', encoding = 'UTF-8', echo=TRUE)
setwd("D:\\dataset\\Bike")
train <- read.csv("train.csv")
test <- read.csv("test.csv")
dim(train); dim(test)
install.packages("Amelia")
library(Amelia)
missmap(train)
missmap(test)
## 모델 생성
pair(train)
## 모델 생성
pairplot(train)
## 모델 생성
str(train)
pairs(train[, 2:9], col=train$season)
pairs(train[, 2:9], col=train$season)
pairs(train[, 2:9])
train
str(train)
## 모델 생성
model <- lm(count~temp+humidity, data=train)
model
## 예측
pred <- predict(model, newdata=test)
pred
kor <- c(50,70,80,90,100)
eng <- c(77,88,99,100,70)
math <- c(55, 75, 85, 95, 105)
all_score <- data.frame(kor, eng, math)
all_score
model1 <- lm(math~kor, data=all_score)
model1
model2 <- lm(math~kor+eng, data=all_score)
model2
# 하나의 변수로 이용한 예측
dat <- data.frame(kor=c(80,85))
pred1 <- predict(model1, newdata=dat)
pred1
# 두개의 변수로 이용한 예측
dat <- data.frame(kor=c(80,85), eng=c(50,60))
pred2 <- predict(model2, newdata=dat)
pred2
summary(model1)
summary(model2)
